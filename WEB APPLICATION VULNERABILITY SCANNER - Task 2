import requests
from bs4 import BeautifulSoup

vuln_payloads = {
    "sql": ["' OR '1'='1", "'; DROP TABLE users; --"],
    "xss": ['<script>alert("XSS")</script>']
}

def scan_url(url):
    try:
        response = requests.get(url)
        soup = BeautifulSoup(response.text, "html.parser")
        forms = soup.find_all("form")
        print(f"Found {len(forms)} form(s).")
        for form in forms:
            action = form.get("action")
            method = form.get("method", "get").lower()
            inputs = form.find_all("input")
            data = {i.get("name"): vuln_payloads['sql'][0] for i in inputs if i.get("name")}
            full_url = url + action if action else url
            if method == "post":
                resp = requests.post(full_url, data=data)
            else:
                resp = requests.get(full_url, params=data)
            if "sql" in resp.text.lower() or "alert" in resp.text.lower():
                print(f"Possible vulnerability at: {full_url}")
    except Exception as e:
        print("Error:", e)

# Example usage
scan_url("http://example.com")
